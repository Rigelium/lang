<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:type" content="website">
<meta property="og:title" content="Deicto | Level Menu">
<meta property="og:description" content="A silly language learning game made by an even sillier student">
<meta property="og:image" content="https://rigelium.github.io/deicto/assets/logo.png">

     
    <link rel="icon" type="image/x-icon" href="https://cdn.discordapp.com/attachments/638813266440880140/1452871487945048154/image.png?ex=694b6383&is=694a1203&hm=ea28a03cd258d23b8acf516ce5d50e8d8c18830545825d3c39ad702c7ab846fc">
    <link rel="stylesheet" href="../assets/styles.css">
    <title>Deicto</title>
  </head>
  <body>

    <input id="input">Type level</input>
    <button id="btn" onclick="saveLocal()">Play level</button>
    <div id="lv-container" style="gap: 10px;"></div>

    
    <script>

      // Trying to load data from the main page (course settings)
      let language = retrieveVariable("language", "Hungarian");
      let langCodeTSS = retrieveVariable("langCodeTSS", "hu-HU"); 
      let difLevel = retrieveVariable("difLevel", "beginner");
      
      const path = language.toLowerCase() + "/" + difLevel + "/";

      listLevels();

      async function listLevels() {
      let checkedLv = 1;
      let endReached = 0;
        while( endReached == 0 ) {
          try {
            const response = await fetch(path + "lv_" + checkedLv + ".json");
            levelData = await response.json();
            dispLevel(checkedLv, levelData.title, levelData.sentences.length); // 
            checkedLv++;
          } catch(error) {
            endReached = 1;
            console.log(error);
          } 
        }
      }



      function dispLevel(levelNumber, levelTitle, numOfSentences) {
        const lvContainer = document.getElementById('lv-container');
        const level = document.createElement('div');
        level.innerHTML = `
        <div class='box1' style="margin-top: 10px;">
          <div style='width:60%; flex-direction: column; justify-content: flex-start;'>
            <a margin: 2px;>Lv. ${levelNumber} - ${levelTitle}</a>
            <div> <!--  -->
              <a>Complete</a>
              
            </div>
          </div>
          <div class="box1" href='../play/' style='width: 20%; ' onclick='selectLevel(${levelNumber})'>
            <a>PLAY</a>
          </div>
        </div>`;

        lvContainer.appendChild(level);
        console.log("Loaded level: " + levelNumber + levelTitle + numOfSentences);
      }

      function selectLevel(levelNr){
        localStorage.setItem('currentLevel', levelNr);
      }








      
      //WIP settings
      const input = document.getElementById('input');
      const btn = document.getElementById('btn');

      function saveLocal() {
        localStorage.setItem('currentLevel', input.value);
        console.log("Go to /play/ to play this level: ${input.value}");
      }

      
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      function retrieveVariable(varName, defaultValue) {
        try {
          const storedValue = localStorage.getItem(varName);
          if (storedValue == null){
            return defaultValue;
          }
          return storedValue;
        } catch(error) {
          console.error(error);
          return defaultValue;
        }
      }
      
    </script>
  </body>
</html>
